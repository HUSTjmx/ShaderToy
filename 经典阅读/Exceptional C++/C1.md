# 条款1：Iterators

:one:设计准则：绝对不要提领一个无效的迭代器。

使用`iterators`时，务必清楚以下四点:

1. 有效的数值：这个迭代器可以提领吗？如果你写`*e.end()`，绝对是个错误。
2. 有效的寿命：这个迭代器被使用时还有效吗？或是它已经因为某些操作而变得无效了。
3. 有效的范围：一对`iterators` 是否组成一个有效范围？
4. ==不合法的操作行为==：**代码**是否企图修改**内建类型的暂时物件**，像`--e.End()`这样？



# 条款2-3：不区分大小写的string

:one:写一个不分大小写的字符串类型，它其它方面都与标准库中的`string`类相同。

首先，我们不难知道`std::string`的本质：

<img src="C1.assets/image-20211111171413999.png" alt="image-20211111171413999" style="zoom: 67%;" />

<img src="C1.assets/image-20211111171429602.png" alt="image-20211111171429602" style="zoom:67%;" />

关键点是`char_trait`部分，它决定了字符的**相互作用和比较运算**（`!`运算）。如果你希望在`string`这些操作上有不同的行为，我们所要做的只是提供一个不同的`char_trait`模板。这是最容易的方法：

![image-20211111171800121](C1.assets/image-20211111171800121.png)

![image-20211111171819977](C1.assets/image-20211111171819977.png)

:two:最终将合并：

<img src="C1.assets/image-20211111172301647.png" alt="image-20211111172301647" style="zoom:67%;" />





# 条款4-5：具有最大可复用性的通用Containers

:one:为下面的==定长向量类==实现**拷贝构造操作**和**拷贝赋值操作**，以提供**最大的可用性**。提示：请考虑用户代码可能会用它做哪些事情。

![image-20211111172731713](C1.assets/image-20211111172731713.png)

![image-20211111172746093](C1.assets/image-20211111172746093.png)

:two:答案如下：

![image-20211111172910588](C1.assets/image-20211111172910588.png)

:three:进行分析。

你以为原本默认构造的拷贝构造和复制函数都不会生成了吗？不！真正的**拷贝构造函数或者拷贝赋值运算符**只对完全相同类型的对象施以**构造或赋值操作**。举个例子：

![image-20211111173640915](C1.assets/image-20211111173640915.png)

![image-20211111173650305](C1.assets/image-20211111173650305.png)

由于==模板构造函数终究不是拷贝构造函数==，因此这种模板的出现并**不会隐藏**原来隐含的拷贝构造函数之声明。如此一来，我们在解答中给出的代码实际上与原来问题中的原始代码==有着相同的拷贝构造函数和拷贝赋值运算符==——因为编译器始终生成它们隐含的版本。我们所做的改动只是**增强了构造操作和赋值操作的可适应性**，而不是替换掉了旧有的版本。

![image-20211111173831723](C1.assets/image-20211111173831723.png)

由此可以看出，本条款的问题所寻求的==真正答案==其实是：提供了具有可适应性的“从其它固定向量进行构造和拷贝的操作”，而不是具有可适应性的“拷贝构造操作和拷贝赋值操作”——它们早就存在了。

:four:我们增加的两个操作具有如下两个主要用途：

- 支持可变的类型（包括继承在内）

  ![image-20211111174422736](C1.assets/image-20211111174422736.png)

- 支持可变的大小。

  ![image-20211111174437495](C1.assets/image-20211111174437495.png)

:five:另一种解答：标准库风格。

![image-20211111174550920](C1.assets/image-20211111174550920.png)

![image-20211111174611600](C1.assets/image-20211111174611600.png)

![image-20211111174659207](C1.assets/image-20211111174659207.png)



# 条款6：临时对象

:one:

